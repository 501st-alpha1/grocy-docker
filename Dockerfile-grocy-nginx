FROM alpine:latest
MAINTAINER Talmai Oliveira <to@talm.ai>

RUN     apk update && \
        apk add --no-cache \
            openssl \
            nginx && \
        mkdir -p /etc/nginx/certificates && \
        mkdir -p /var/run/nginx && \
        openssl req \
                -x509 \
                -newkey rsa:2048 \
                -keyout /etc/nginx/certificates/key.pem \
                -out /etc/nginx/certificates/cert.pem \
                -days 365 \
                -nodes \
                -subj /CN=localhost

COPY docker_nginx /etc/nginx

VOLUME ["/etc/nginx/conf.d", "/var/log/nginx"]

EXPOSE 80 443

ENTRYPOINT ["/usr/sbin/nginx", "-g", "daemon off;"]
